/**
* Networking Lab
* CS 241 - Spring 2018
*/

#include "common.h"

size_t read_from_socket(int sock_fd, char* line, size_t num){
    size_t byte_read = 0;
    while (byte_read < num) {
        ssize_t new_read = read(sock_fd, line + byte_read, num - byte_read);
        if (new_read == 0)
            return byte_read;
        if (new_read == -1 && errno == EINTR)
            continue;
        if (new_read == -1 && errno != EINTR)
            return -1;
        byte_read += new_read;
    }
    return byte_read;
}

size_t write_to_socket(int sock_fd, char* line, size_t num){
    size_t byte_write = 0;
    while (byte_write < num) {
        ssize_t new_write = write(sock_fd, line + byte_write, num - byte_write);
        if (new_write == 0)
            return byte_write;
        if (new_write == -1 && errno == EINTR)
            continue;
        if (new_write == -1 && errno != EINTR)
            return -1;
        byte_write += new_write;
    }
    return byte_write;
}
